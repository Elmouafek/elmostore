<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; padding: 0;
      display: flex; justify-content: center;
      background: linear-gradient(to right, #f9f9f9, #ececec);
    }
    .container {
      display: flex; gap: 20px; margin: 40px;
      width: 95%; max-width: 1100px;
    }
    .form-box, .summary-box {
      background: white; padding: 25px;
      border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      flex: 1;
    }
    h2 { margin-top: 0; color: #333; }
    label { display: block; margin-top: 15px; font-weight: 600; }
    input, select {
      width: 100%; padding: 10px;
      margin-top: 6px; border: 1px solid #ccc; border-radius: 8px;
      font-size: 15px;
    }
    .summary-box {
      max-width: 400px; position: sticky; top: 30px;
    }
    .summary-card {
      background: #fafafa; border: 1px solid #eee;
      padding: 15px; border-radius: 12px;
    }
    .btn-paypal {
      background-color: #ffc439; color: #111;
      border: none; border-radius: 10px;
      padding: 14px 20px; font-size: 18px;
      font-weight: bold; cursor: pointer;
      margin-top: 25px; width: 100%;
      transition: all 0.2s ease-in-out;
    }
    .btn-paypal:hover {
      background-color: #ffb300;
      transform: translateY(-2px);
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div class="container">
    
    <!-- Client Form -->
    <div class="form-box">
      <h2>Customer Information</h2>
      <form id="orderForm" name="order-form" method="POST" data-netlify="true">
        
        <label>Full Name</label>
        <input type="text" name="name" id="name" required>

        <label>Email Address</label>
        <input type="email" name="email" id="email" required>

        <label>Shipping Address</label>
        <input type="text" name="address" id="address" required>

        <label>Product Color</label>
        <select name="color" id="color" onchange="updateSummary()">
          <option value="Black">Black</option>
          <option value="White">White</option>
          <option value="Blue">Blue</option>
        </select>

        <label>Product Size</label>
        <select name="size" id="size" onchange="updateSummary()">
          <option value="Small">Small</option>
          <option value="Medium">Medium</option>
          <option value="Large">Large</option>
        </select>

        <label>Quantity</label>
        <input type="number" id="qty" name="quantity" value="1" min="1" onchange="updateSummary()" required>

        <label>Notes</label>
        <input type="text" name="notes" id="notes">

      </form>
    </div>

    <!-- Order Summary -->
    <div class="summary-box">
      <h2>Order Summary</h2>
      <div class="summary-card" id="summaryCard">
        <p id="sum-name">Name: -</p>
        <p id="sum-email">Email: -</p>
        <p id="sum-address">Address: -</p>
        <hr>
        <p><b>Product:</b> Custom Item</p>
        <p id="sum-color">Color: Black</p>
        <p id="sum-size">Size: Small</p>
        <p id="sum-qty">Quantity: 1</p>
        <p><b>Price per unit:</b> $10</p>
        <p id="sum-total"><b>Total: $10</b></p>
      </div>

      <!-- Single Button -->
      <button class="btn-paypal" onclick="submitAndPay()">Submit & Pay with PayPal</button>
    </div>
  </div>

  <script>
    const price = 10;

    function updateSummary() {
      let qty = document.getElementById("qty").value;
      let color = document.getElementById("color").value;
      let size = document.getElementById("size").value;
      let total = price * qty;

      document.getElementById("sum-color").innerText = "Color: " + color;
      document.getElementById("sum-size").innerText = "Size: " + size;
      document.getElementById("sum-qty").innerText = "Quantity: " + qty;
      document.getElementById("sum-total").innerHTML = "<b>Total: $" + total + "</b>";

      // update personal info in summary
      document.getElementById("sum-name").innerText = "Name: " + (document.getElementById("name").value || "-");
      document.getElementById("sum-email").innerText = "Email: " + (document.getElementById("email").value || "-");
      document.getElementById("sum-address").innerText = "Address: " + (document.getElementById("address").value || "-");
    }

    async function submitAndPay() {
      let form = document.getElementById("orderForm");
      let formData = new FormData(form);

      // Send data to Netlify
      await fetch("/", {
        method: "POST",
        body: formData
      });

      // Redirect to PayPal.me with total amount
      let qty = document.getElementById("qty").value;
      let total = price * qty;
      window.open("https://paypal.me/EElkali/" + total, "_blank");
    }

    // keep updating summary live
    document.querySelectorAll("input, select").forEach(el => {
      el.addEventListener("input", updateSummary);
    });

    // initial summary
    updateSummary();
  </script>
</body>
</html>
